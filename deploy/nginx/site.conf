server {
	listen 80 default_server;
	listen [::]:80 default_server ipv6only=on;

	root /home/bizlunch/app/webapp;
	index index.html index.htm;

	server_name my.bizlunch.fr;

	location ~* ^.+\.(?:html|htm|xml)$
	{
		access_log off;
		expires 1h;
	}

	location ~* ^.+\.(?:css|cur|js|jpe?g|gif|htc|ico|png|otf|ttf|eot|woff|svg)$
	{
        access_log off;
        expires 120d;
        ## No need to bleed constant updates. Send the all shebang in one
        ## fell swoop.
        tcp_nodelay off;
        ## Set the OS file cache.
        open_file_cache max=3000 inactive=120s;
        open_file_cache_valid 1d;
        open_file_cache_min_uses 2;
        open_file_cache_errors off;
    	}

	location ^~ /api/
	{
		rewrite    /api/(.*) /$1 break;

		proxy_set_header Host "api.bizlunch.fr";
		proxy_pass http://127.0.0.1;
        proxy_set_header        X-Real-IP       $remote_addr;
        proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header        X-URI   $scheme://$host$request_uri;
	}

	location / {
		try_files $uri $uri/ =404;
	}
}